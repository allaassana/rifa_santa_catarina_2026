<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <title>Rifa Santa Catarina 2025</title>

  <link rel="stylesheet" href="css/style.css" />

  <style>
    body {
      background:#f6f7f9;
      font-family: Arial, sans-serif;
      margin:0;
    }

    header {
      background:#1f3a5f;
      color:#fff;
      padding:30px;
      text-align:center;
    }

    .container {
      max-width:1200px;
      margin:20px auto;
      padding:20px;
    }

    .grid {
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(48px,1fr));
      gap:6px;
    }

    .available {
      background:#a8d27a;
      border:none;
      padding:10px;
      border-radius:6px;
      cursor:pointer;
      font-weight:bold;
    }

    .sold {
      background:#ddd;
      border:none;
      padding:10px;
      border-radius:6px;
      cursor:not-allowed;
    }

    .hidden {
      display:none !important;
    }

    input {
      padding:8px;
      margin:5px 0;
      width:100%;
      max-width:300px;
      display:block;
    }

    .btn {
      padding:8px 14px;
      border-radius:6px;
      border:none;
      cursor:pointer;
      margin:5px;
      font-weight:bold;
    }

    .btn.green { background:#4CAF50; color:#fff; }
    .btn.blue  { background:#1f3a5f; color:#fff; }

    /* MODAL */
    .modal {
      position: fixed;
      inset:0;
      background:rgba(0,0,0,.6);
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:9999;
    }

    .modal-box {
      background:#fff;
      padding:25px;
      border-radius:10px;
      width:320px;
      text-align:center;
    }
  </style>
</head>

<body>

<header>
  <h1>Rifa Santa Catarina 2025</h1>
  <p>Centro Pastoral Santa Ana & SÃ£o Joaquim</p>
</header>

<div class="container">

  <p>
    <strong>Vendidos:</strong> <span id="soldCount">0</span> |
    <strong>DisponÃ­veis:</strong> <span id="availCount">120</span>
  </p>

  <!-- GRELHA -->
  <div id="ticketGrid" class="grid"></div>

  <!-- FORMULÃRIO -->
  <div id="formArea" class="hidden">
    <h3>Bilhete NÂº <span id="ticketNumber"></span></h3>

    <input id="nome" placeholder="Nome *">
    <input id="telefone" placeholder="Telefone *">
    <input id="email" placeholder="Email *">
    <input id="nascimento" type="date">
    <input id="cidade" placeholder="Cidade">
    <input id="pais" placeholder="PaÃ­s">
    <input id="comprovativo" type="file">

    <br>
    <button id="confirmar" class="btn green">Confirmar Compra</button>
    <button id="cancelar" class="btn">Cancelar</button>
  </div>

  <!-- REGULAMENTO -->
  <div style="margin-top:30px">
    <a
      href="https://drive.google.com/file/d/1TeVBGckN8YbeV2g_-cvc-qTAL_SoVhso/view?usp=sharing"
      target="_blank"
      class="btn blue"
    >
      ðŸ“„ Ver Regulamento
    </a>
  </div>

</div>

<!-- MODAL COMPRA CONFIRMADA -->
<div id="modal" class="modal hidden">
  <div class="modal-box">
    <h3>âœ… Compra Confirmada</h3>

    <p><strong>Bilhete:</strong> <span id="modalBilhete"></span></p>
    <p><strong>Nome:</strong> <span id="modalNome"></span></p>

    <a id="whatsappBtn" target="_blank" class="btn green">
      ðŸ“² Enviar WhatsApp
    </a>

    <br><br>
    <button id="fecharModal" class="btn">Fechar</button>
  </div>
</div>

<!-- SUPABASE -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  window.db = supabase.createClient(
    "https://ydyuxumwqnuhomahaxet.supabase.co",
    "sb_publishable_mTc8Aoplv-HTj-23xoMZ_w_gzoQkN3u"
  );
</script>

<!-- MODAL CONTROL -->
<script>
  function mostrarModal(bilhete, nome, telefone) {
    document.getElementById("modalBilhete").textContent = bilhete;
    document.getElementById("modalNome").textContent = nome;

    const msg = `OlÃ¡, aqui estÃ¡ o bilhete nÃºmero ${bilhete}.\nCompra confirmada!`;

    document.getElementById("whatsappBtn").href =
      `https://wa.me/238${telefone}?text=${encodeURIComponent(msg)}`;

    document.getElementById("modal").classList.remove("hidden");
  }

  document.getElementById("fecharModal").onclick = () => {
    document.getElementById("modal").classList.add("hidden");
  };
</script>

<!-- JS PRINCIPAL -->
<script src="js/index.js"></script>

</body>
</html>
